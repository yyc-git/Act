# 三国战记-横版动作类游戏

> 作者：YYC

> 版本：v0.1


## 设计思路
----------
使用我的YEngine2D作为游戏引擎
使用jasmine+sinon作为测试工具，其中单元测试引擎全覆盖，游戏核心代码覆盖

### 包图
![_](http://img1.tbcdn.cn/L1/461/1/0032e1e222ff4020e87bed36cd516feade8aba60)

### 游戏领域模型
![_](http://img3.tbcdn.cn/L1/461/1/cc03bc6f0b6939c9408b037fd23d503b31721940)

**职责说明**

 - LevelManager
关卡管理类，负责调度关卡，启动游戏

 - Scene
场景类，负责游戏场景的初始化，包括绑定键盘事件、创建层和精灵等

 - Layer
层类，与游戏画布为1对1的关系，负责画布逻辑和管理层内元素。
游戏中具体有EntityLayer和MapLayer类，分别负责管理精灵类和实现地图逻辑。

 - Sprite
精灵类，负责精灵的相关逻辑。
游戏中具体有PlayerSprite和EnemySprite类，以及它们的基类Sprite。PlayerSprite负责玩家控制的“张飞”的逻辑，EnemySprite负责“夏侯渊”的逻辑。

 - CustomAction
自定义动作类。
游戏中具体有CommonAttack和JumpAttack类，以及它们的基类Attack。CommonAttack负责“张飞”普通攻击动作的用户逻辑，JumpAttack负责“张飞”跳跃攻击动作的用户逻辑。

 - KeyManager
键盘事件管理类，负责键盘事件的管理和内部键盘状态容器的管理。

 - ui
界面类，负责与页面的dom交互。
 
 - config
配置类，放置精灵类的配置属性。

 - data
数据类，放置游戏数据。
游戏中具体有关卡数据类levelData、资源表resourceTable、帧数据和动画数据、地图背景图片和精灵图片。
 
### 动画与动作
引擎的Animate动作负责实现动画播放，因此播放动画也是动作。
动画动作与其它动作都在同一个队列中执行。

### 引擎动作和用户自定义动作
引擎已经实现了若干动作类，用户可以直接使用。
用户也可以创建自定义动作（如CommonAttack类），实现用户逻辑。

游戏中，精灵的移动、站立、跑动、跳跃、倒地、受伤动作都是直接使用引擎动作实现的，精灵的普通攻击、跳跃攻击动作则是组合使用了引擎动作和用户自定义动作实现的。

  
### 页面说明
index.html为游戏页面
test_engine.html为引擎单元测试页面
test_act.html为游戏单元测试页面

## 功能实现
目前已实现的功能：

1、地图滚动 

2、显示精灵和背景地图 

3、玩家可通过键盘操作张飞：

w、s、a、d键分别为上下左右方向键
 
连续点击同一方向键两次，可跑动 

按j可普通攻击敌人 

按空格键space可跳跃 

跳跃过程中按j可跳跃攻击敌人

4、敌人可被攻击，并显示受伤或倒地效果。
敌人被攻击第3次后会倒地。
